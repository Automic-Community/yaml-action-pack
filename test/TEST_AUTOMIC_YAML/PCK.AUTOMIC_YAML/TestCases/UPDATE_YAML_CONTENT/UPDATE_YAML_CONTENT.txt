*** Settings ***
Suite Setup       Startup
Suite Teardown    Teardown
Force Tags        UPDATE_YAML_CONTENT
Test Template     UPDATE_YAML_CONTENT Template
Library           com.automic.robot.itpa.ItpaLibrary
Library           String
Library           DateTime
Resource          ../../Resources/messages.txt
Resource          ../../Resources/Is_Arraywords.txt
Resource          ../../Resources/Names.txt
Resource          ../../Resources/actions.txt

*** Test Cases ***    OK_NOK    YAML_File_Path       YAML_Content       YAML_Path       Is_Array        Value       Download_Path
UPDATE_YAML_CONTENT from YAMLFile
                      [Tags]    main_scenarios
                      OK        ${YAMLFilePath}    ${EMPTY}          ${YAMLPath}    No     ${Value}         ${Download_Path}
					  
UPDATE_YAML_ARRAY in YAMLFile
                      OK        ${YAMLFilePath}    ${EMPTY}          ${YAMLArrayPath}    Yes     ${ArrayValue}          ${Download_Path_Array}
					  
UPDATE_YAML_OBJECT in YAMLFile
                      OK        ${YAMLFilePath}    ${EMPTY}          ${YAMLObjectPath}    No     ${ObjectValue}          ${Download_Path_Object}					  		  

UPDATE_YAML from YAMLContent
                      OK        ${EMPTY}           ${YAMLContent}    ${YAMLPath}    ${Is_Array}     ${Value}         ${Download_Path}

UPDATE_YAML_CONTENT with invalid YAMLFilePath
                      NOK       INVALID            ${EMPTY}          ${YAMLPath}    ${Is_Array}     ${Value}         ${Download_Path}

UPDATE_YAML_CONTENT with invalid YAMLContent
                      NOK       ${EMPTY}           INVALID           ${YAMLPath}    ${Is_Array}     ${Value}         ${Download_Path}

UPDATE_YAML_CONTENT with invalid YAMLPath
                      NOK       ${YAMLFilePath}    ${EMPTY}          INVALID        ${Is_Array}     ${Value}         ${Download_Path}

UPDATE_YAML_CONTENT with invalid Is_Array
                      NOK        ${YAMLFilePath}    ${EMPTY}          ${YAMLPath}    INVALID    ${Value}         ${Download_Path}

UPDATE_YAML_CONTENT with invalid value
                      OK        ${YAMLFilePath}    ${EMPTY}          ${YAMLPath}    ${Is_Array}     INVALID        ${Download_Path}
					  
UPDATE_YAML_CONTENT with both yamlFile and yamlContent
                      NOK        ${YAMLFilePath}    ${YAMLContent}        ${YAMLPath2}    ${Key}     ${EMPTY}         ${Download_Path}
					  
UPDATE_YAML_CONTENT with both YAMLFile and YAMLContent as empty
                      NOK        ${EMPTY}    ${EMPTY}          ${YAMLPath2}    ${Key}     ${EMPTY}         ${Download_Path}

UPDATE_YAML_CONTENT with Empty Value
                      OK        ${YAMLFilePath}    ${EMPTY}          ${YAMLPath}    ${Is_Array}     ${EMPTY}      ${Download_Path}

UPDATE_YAML_CONTENT with Empty Download Path
                      OK        ${YAMLFilePath}    ${EMPTY}          ${YAMLPath}    ${Is_Array}     ${EMPTY}          ${EMPTY}

UPDATE_YAML_CONTENT with Invalid Download Path
                      OK        ${YAMLFilePath}    ${EMPTY}          ${YAMLPath}    ${Is_Array}     ${EMPTY}         INVALID

*** Is_Arraywords ***
Startup
    Log    *******Start Test "UPDATE_YAML_CONTENT"*******
    Log    *******Connect to AE*******
    Connect AE

UPDATE_YAML_CONTENT Template
    [Arguments]    ${OK_NOK}    ${YAML_File_Path}    ${YAML_Content}    ${YAML_Path}    ${Is_Array}    ${Value}    ${Download_Path}
    [Documentation]    This test tests the feature of UPDATE_YAML_CONTENT.
    ...    -${OK_NOK}: Boolean value indicate if the action is ENDED_OK or ENDED_NOT_OK. Value of this Name should be OK or NOK.
    ...    -${YAML_File_Path}: This field specifies the full path to the YAML file.
    ...    -${YAML_Content}: This field specifies the YAML content or a variable that contains YAML content.
    ...    -${YAML_Path}: This field specifies path to the element in YAML content to be updated.
    ...    -${Is_Array}: This field specifies if element being updates is an array type.
    ...    -${Value}: This field specifies the new value to be set.
    ...    -${Download_Path}: This field Specify path to download modified file. E.g. D:\YAML\filename.YAML
    Generate String
    Init Action    ${UPDATE_YAML_CONTENT_ACTION}
    Run Is_Arrayword If    '${YAML_File_Path}' == 'Invalid'    Action Set    &UC4RB_JSN_YAML_FILE#    ${Generated_Name}_${Time}    ELSE    Action Set
    ...    &UC4RB_JSN_YAML_FILE#    ${YAML_File_Path}
    Run Is_Arrayword If    '${YAML_Content}' == 'Invalid'    Action Set    &UC4RB_JSN_YAML#    ${Generated_Name}_${Time}    ELSE    Action Set
    ...    &UC4RB_JSN_YAML#    ${YAML_Content}
    Run Is_Arrayword If    '${YAML_Path}' == 'Invalid'    Action Set    &UC4RB_JSN_PATH#    ${Generated_Name}_${Time}    ELSE    Action Set
    ...    &UC4RB_JSN_PATH#    ${YAML_Path}
    Run Is_Arrayword If    '${Is_Array}' == 'Invalid'    Action Set    &UC4RB_JSN_Is_Array#    ${Generated_Name}_${Time}    ELSE    Action Set
    ...    &UC4RB_JSN_Is_Array#    ${Is_Array}
    Run Is_Arrayword If    '${Value}' == 'Invalid'    Action Set    &UC4RB_JSN_VALUE#    ${Generated_Name}_${Time}    ELSE    Action Set
    ...    &UC4RB_JSN_VALUE#    ${Value}
    Run Is_Arrayword If    '${Download_Path}' == 'Invalid'    Action Set    &UC4RB_JSN_DWNLD_PATH#    ${Generated_Name}_${Time}    ELSE    Action Set
    ...    &UC4RB_JSN_DWNLD_PATH#    ${Download_Path}
    Action Execute
    Run Is_Arrayword If    '${OK_NOK}' == 'OK'    Assert Success    ELSE    Assert Failure
    Run Is_Arrayword If    '${OK_NOK}' == 'OK'    Action Object Variable Should Be Found    &UC4RB_JSN_UPDATED_YAML#    ELSE    Action Object Variable Should Not Be Found    &UC4RB_JSN_UPDATED_YAML#

Teardown
    Log    *******End Test "UPDATE_YAML_CONTENT"*******
